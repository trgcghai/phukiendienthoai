<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="../assets/bootstrap-5.3.3-dist/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="../css/library.css" />
    <link rel="stylesheet" href="../css/header.css" />
    <link rel="stylesheet" href="../css/footer.css" />
    <link rel="stylesheet" href="../css/userPage.css" />
    <script src="../assets/bootstrap-5.3.3-dist/js/bootstrap.min.js"></script>
    <script src="../js/jquery-3.7.1.min.js"></script>
    <title>Document</title>
  </head>
  <body class="position-relative">
    <header
      class="header position-fixed top-0 start-0 end-0 z-1 d-flex align-items-center justify-content-center"
    >
      <div
        class="header_container container p-0 d-flex align-items-center justify-content-between"
      >
        <div class="logo">
          <a
            href="../index.html"
            class="header_link d-block text-light cursor-pointer text-decoration-none"
            >Phukiendienthoai</a
          >
        </div>

        <div
          class="categories d-none d-sm-none d-md-none d-lg-flex d-xl-flex d-xxl-flex align-items-center justify-content-between text-light cursor-pointer"
        >
          <div class="category_icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 512 512"
            >
              <path
                fill="white"
                d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"
              />
            </svg>
          </div>
          <span class="categories_text">Danh mục</span>
        </div>

        <div
          class="search_box d-none d-sm-flex d-md-flex d-lg-flex d-xl-flex d-xxl-flex align-items-center position-relative"
        >
          <input
            type="text"
            class="search_input border-0"
            placeholder="Bạn cần tìm gì ?"
          />
          <div class="search_icon position-absolute cursor-pointer">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 512 512"
            >
              <path
                fill="gray"
                d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"
              />
            </svg>
          </div>
        </div>

        <div
          class="cart d-none d-sm-block d-md-block d-lg-block d-xl-block d-xxl-block"
        >
          <a
            href="./cart.html"
            class="cart_link text-decoration-none d-flex align-items-center text-light cursor-pointer"
          >
            <div class="cart_icon">
              <svg
                viewBox="0 0 20 20"
                width="23"
                height="23"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M4.22111 3L3.84216 1H1M4.22111 3H19L15.2105 12.0455H5.73689M4.22111 3L5.73689 12.0455M5.73689 12.0455L3.56458 13.293C2.96774 13.923 3.5309 14.9091 4.375 14.9091H9.625H12.25L15.2105 15M15.2105 15C14.708 15 14.2261 15.2107 13.8708 15.5858C13.5154 15.9609 13.3158 16.4696 13.3158 17C13.3158 17.5304 13.5154 18.0391 13.8708 18.4142C14.2261 18.7893 14.708 19 15.2105 19C15.7131 19 16.195 18.7893 16.5503 18.4142C16.9056 18.0391 17.1053 17.5304 17.1053 17C17.1053 16.4696 16.9056 15.9609 16.5503 15.5858C16.195 15.2107 15.7131 15 15.2105 15ZM7.63162 17C7.63162 17.5304 7.432 18.0391 7.07667 18.4142C6.72134 18.7893 6.2394 19 5.73689 19C5.23438 19 4.75245 18.7893 4.39711 18.4142C4.04178 18.0391 3.84216 17.5304 3.84216 17C3.84216 16.4696 4.04178 15.9609 4.39711 15.5858C4.75245 15.2107 5.23438 15 5.73689 15C6.2394 15 6.72134 15.2107 7.07667 15.5858C7.432 15.9609 7.63162 16.4696 7.63162 17Z"
                  stroke="white"
                  stroke-width="1.7"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                ></path>
              </svg>
            </div>
            <span class="cart_link_text">Giỏ hàng</span>
          </a>
        </div>

        <div
          class="user d-none d-sm-block d-md-block d-lg-block d-xl-block d-xxl-block"
        >
          <a
            href="./login.html"
            class="user_link d-flex align-items-center justify-content-between text-light cursor-pointer text-decoration-none"
          >
            <div class="user_icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="23"
                height="23"
                viewBox="0 0 448 512"
              >
                <path
                  fill="white"
                  d="M304 128a80 80 0 1 0 -160 0 80 80 0 1 0 160 0zM96 128a128 128 0 1 1 256 0A128 128 0 1 1 96 128zM49.3 464H398.7c-8.9-63.3-63.3-112-129-112H178.3c-65.7 0-120.1 48.7-129 112zM0 482.3C0 383.8 79.8 304 178.3 304h91.4C368.2 304 448 383.8 448 482.3c0 16.4-13.3 29.7-29.7 29.7H29.7C13.3 512 0 498.7 0 482.3z"
                />
              </svg>
            </div>
            <span class="user_text">Đăng nhập</span>
          </a>
        </div>

        <div
          class="icon_toggle d-block d-sm-none d-md-none d-lg-none d-xl-none d-xxl-none"
        >
          <div class="icon px-3" style="cursor: pointer">
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarSupportedContent"
              aria-controls="navbarSupportedContent"
              aria-expanded="false"
              aria-label="Toggle navigation"
              onclick="document.querySelector('.toggle_list').classList.toggle('d-none')"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="22"
                height="22"
                viewBox="0 0 512 512"
              >
                <path
                  fill="white"
                  d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"
                />
              </svg>
            </button>
          </div>

          <ul
            class="d-none toggle_list position-absolute start-0 list-unstyled w-100"
          >
            <li class="toggle_item py-2 position-relative">
              <input
                type="text"
                class="search_input border-0 w-100"
                placeholder="Bạn cần tìm gì ?"
              />
              <div
                class="position-absolute cursor-pointer"
                style="right: 12px; top: 13px"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 512 512"
                  style="cursor: pointer"
                >
                  <path
                    fill="gray"
                    d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"
                  />
                </svg>
              </div>
            </li>
            <li class="toggle_item text-light py-2 collapse_categories">
              Danh mục
            </li>

            <li class="toggle_item text-light py-2">
              <a
                href="./cart.html"
                class="toggle_link px-0 cart_link d-inline-block w-100 text-decoration-none text-light"
                >Giỏ hàng</a
              >
            </li>
            <li class="toggle_item text-light py-2">
              <a
                href="./login.html"
                class="toggle_link px-0 border-0 user_link d-inline-block w-100 text-decoration-none text-light"
                >Đăng nhập</a
              >
            </li>
          </ul>
        </div>
      </div>
    </header>

    <div class="header_wrapper"></div>

    <main class="container mb-2 position-relative">
      <div class="row gap-3 m-0 p-0">
        <div class="col col-3"></div>
        <div
          class="col col-6"
          style="
            background-color: #fff;
            border-radius: 12px;
            border: 1px solid #ccc;
          "
        >
          <div class="form_container">
            <div class="form_title fs-4 text-center my-2">
              Thông tin khách hàng
            </div>
            <form>
              <div class="mb-3">
                <label for="userEmail" class="form-label">Email</label>
                <input type="email" class="form-control" id="userEmail" />
              </div>
              <div class="mb-3">
                <label for="userName" class="form-label">Username</label>
                <input type="text" class="form-control" id="userName" />
              </div>
              <div class="mb-3">
                <label for="userRealName" class="form-label">Họ và tên</label>
                <input type="text" class="form-control" id="userRealName" />
              </div>
              <div class="mb-3">
                <label for="userPhone" class="form-label">Số điện thoại</label>
                <input type="text" class="form-control" id="userPhone" />
              </div>
              <div class="mb-3">
                <label for="userAddress" class="form-label">Địa chỉ</label>
                <input type="text" class="form-control" id="userAddress" />
              </div>
              <div class="mb-3">
                <label for="userBirthday" class="form-label">Ngày sinh</label>
                <input type="date" class="form-control" id="userBirthday" />
              </div>
              <div class="mb-4">
                <label for="" class="form-label">Giới tính</label>
                <div class="wrapper">
                  <div class="form-check form-check-inline">
                    <input
                      class="form-check-input"
                      type="radio"
                      name="gender"
                      id="male-check"
                      value="male"
                      checked
                    />
                    <label class="form-check-label" for="male-check">Nam</label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input
                      class="form-check-input"
                      type="radio"
                      name="gender"
                      id="female-check"
                      value="female"
                    />
                    <label class="form-check-label" for="female-check"
                      >Nữ</label
                    >
                  </div>
                </div>
              </div>
              <div class="mb-3 row p-0 m-0 gap-2">
                <button
                  type="button"
                  class="m-0 update_btn col btn btn-primary border-0"
                >
                  Cập nhật
                </button>
                <a
                  href="./webInfo.html"
                  type="button"
                  class="m-0 web_detail col col-auto btn btn-primary border-0"
                >
                  Thông tin trang web
                </a>
                <button
                  type="button"
                  class="m-0 changepass_btn col btn btn-primary border-0"
                >
                  Đổi mật khẩu
                </button>
                <button
                  type="button"
                  class="m-0 logout_btn col btn btn-primary border-0"
                >
                  Đăng xuất
                </button>
              </div>
            </form>
          </div>
        </div>
        <div class="col col-3"></div>
      </div>

      <div
        class="categories_list_container position-absolute d-none"
        style="top: 12px; right: 0; left: 0"
      >
        <ul class="categories_list row m-0">
          <li
            class="categories_item p-0 col col-6 col-md-4 col-lg-2 col-xl-2 col-xxl-2"
          >
            <a href="./allBoSacProducts.html" class="categories_item_link"
              >Bộ sạc</a
            >
          </li>
          <li
            class="categories_item p-0 col col-6 col-md-4 col-lg-2 col-xl-2 col-xxl-2"
          >
            <a href="./allDaySacProducts.html" class="categories_item_link"
              >Dây sạc</a
            >
          </li>
          <li
            class="categories_item p-0 col col-6 col-md-4 col-lg-2 col-xl-2 col-xxl-2"
          >
            <a href="./allPinDuPhongProducts.html" class="categories_item_link"
              >Pin dự phòng</a
            >
          </li>
          <li
            class="categories_item p-0 col col-6 col-md-4 col-lg-2 col-xl-2 col-xxl-2"
          >
            <a href="./allTaiNgheProducts.html" class="categories_item_link"
              >Tai nghe</a
            >
          </li>
          <li
            class="categories_item p-0 col col-6 col-md-4 col-lg-2 col-xl-2 col-xxl-2"
          >
            <a href="./allAppleProducts.html" class="categories_item_link"
              >Phụ kiện Apple</a
            >
          </li>
          <li
            class="categories_item p-0 col col-6 col-md-4 col-lg-2 col-xl-2 col-xxl-2"
          >
            <a href="./allOtherProducts.html" class="categories_item_link"
              >Khác
            </a>
          </li>
        </ul>
      </div>
    </main>

    <footer
      class="footer clearfix position-absolute bottom-0 w-100 text-light d-flex align-items-center justify-content-center"
    >
      <div
        class="footer_container container d-flex align-items-center justify-content-center p-0"
      >
        <div class="copyright">
          © 2024 - Bản quyền thuộc về Phukiendienthoai
        </div>
      </div>
    </footer>

    <div class="backdrop"></div>

    <div class="form resetPassword_form d-none position-absolute">
      <div
        class="wrapper_icon p-2 position-absolute"
        style="top: 12px; right: 12px"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          height="22"
          class="form_icon"
          viewBox="0 0 384 512"
        >
          <path
            d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"
          />
        </svg>
      </div>
      <h2 class="form_title mb-3">Đặt lại mật khẩu</h2>
      <form>
        <div class="form_section mb-3">
          <label for="reset_password" class="form-label">Mật khẩu mới</label>
          <input
            required
            type="password"
            class="form-control"
            id="reset_password"
            aria-describedby="reset-passwordHelp"
          />
          <div id="reset-passwordHelp" class="form-text"></div>
        </div>
        <div class="form_section mb-3">
          <label for="reset_cfpassword" class="form-label"
            >Nhập lại mật khẩu</label
          >
          <input
            required
            type="password"
            class="form-control"
            id="reset_cfpassword"
            aria-describedby="reset-cfpasswordHelp"
          />
          <div id="reset-cfpasswordHelp" class="form-text"></div>
        </div>
        <div class="form_section mb-3 mt-4 d-grid">
          <button class="btn btn-primary confirm_btn border-0">Xác nhận</button>
        </div>
      </form>
    </div>

    <div class="toast-container position-fixed top-0 end-0 p-3">
      <div
        id="liveToast"
        class="toast"
        style="background-color: rgba(255, 255, 255, 1) !important"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
        data-bs-autohide="true"
        data-bs-delay="5000"
      >
        <div class="d-flex">
          <div class="toast-body fs-6">Cập nhật thông tin thành công !!</div>
          <button
            type="button"
            class="btn-close me-2 m-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
      </div>
    </div>
    <script src="../js/checkLogin.js"></script>

    <script src="../js/handleCategoryModal.js"></script>

    <script>
      $(document).ready(() => {
        const userEmail = $("#userEmail");
        const userName = $("#userName");
        const userRealName = $("#userRealName");
        const userPhone = $("#userPhone");
        const userAddress = $("#userAddress");
        const userBirthday = $("#userBirthday");
        const userGenderMale = $("#male-check");
        const userGenderFemale = $("#female-check");
        const showChangePass = $(".changepass_btn");
        const hideChangePass = $(".wrapper_icon");
        const toast = new bootstrap.Toast($("#liveToast"));

        const validateDataUpdate = () => {
          const isUserNameValid = /^[a-zA-Z0-9_-]{8,}$/.test(userName.val());
          const isRealNameValid = /^[a-zA-Z0-9-_]{8,}$/.test(
            userRealName.val()
          );
          const isEmailValid =
            /^[a-zA-Z0-9]{6,}\.[a-zA-Z]{4,}\@[a-zA-Z]{5,}\.[a-zA-Z]{3,}$/.test(
              userEmail.val()
            );
          const isPhoneValid = /^[0-9]{10,}$/.test(userPhone.val());
          const isAddressValid = /^[a-zA-Z0-9-_]{1,}$/.test(userAddress.val());
          const isBirthdayValid = /^[0-9]{4,}-[0-9]{2}-[0-9]{2}$/.test(
            userBirthday.val()
          );

          if (!isUserNameValid) {
            userName.val("");
          }

          if (!isRealNameValid) {
            userRealName.val("");
          }

          if (!isPhoneValid) {
            userPhone.val("");
          }

          if (!isAddressValid) {
            userAddress.val("");
          }

          if (!isBirthdayValid) {
            userBirthday.val("");
          }

          if (!isEmailValid) {
            userEmail.val("");
          }

          return (
            isEmailValid ||
            isUserNameValid ||
            isRealNameValid ||
            isAddressValid ||
            isPhoneValid ||
            isBirthdayValid
          );
        };

        const closeToast = $(".btn-close");
        closeToast.click(() => {
          toast.hide();
        });

        showChangePass.click(() => {
          $(".resetPassword_form").removeClass("d-none");
          $(".backdrop").addClass("d-block");
        });

        hideChangePass.click(() => {
          $(".resetPassword_form").addClass("d-none");
          $(".backdrop").removeClass("d-block");
        });

        $(".backdrop").click(() => {
          $(".resetPassword_form").addClass("d-none");
          $(".backdrop").removeClass("d-block");
        });

        const user = JSON.parse(localStorage.getItem("user") || "null");
        if (user) {
          userName.val(user.name);
          userEmail.val(user.email);
          userRealName.val(user.realName);
          userAddress.val(user.address);
          userBirthday.val(user.birthday);
          userPhone.val(user.phone);
          if (user.gender === "male" || user.gender === null) {
            userGenderMale.prop("checked", true);
          } else if (user.gender === "female") {
            userGenderFemale.prop("checked", true);
          }
        } else {
          userGenderMale.prop("checked", true);
        }

        $(".update_btn").click(() => {
          if (validateDataUpdate()) {
            toast.show();
          }

          localStorage.setItem(
            "user",
            JSON.stringify({
              name: userName.val().trim(),
              email: userEmail.val().trim(),
              realName: userRealName.val().trim(),
              address: userAddress.val().trim(),
              birthday: userBirthday.val().trim(),
              phone: userPhone.val().trim(),
              gender: userGenderMale.prop("checked")
                ? userGenderMale.val()
                : userGenderFemale.val(),
            })
          );
        });

        $(".logout_btn").click((e) => {
          e.preventDefault();
          localStorage.removeItem("user");
          window.location.href = "./login.html";
        });
      });
    </script>

    <script>
      const categoriesShow = $(".categories");
      categoriesShow.click(() => {
        $(".categories_list_container").removeClass("d-none");
      });

      const backdropHide = $(".backdrop");
      backdropHide.click(() => {
        $(".categories_list_container").addClass("d-none");
      });
    </script>

    <script type="module" src="../js/handleSearchBar.js"></script>
  </body>
</html>
