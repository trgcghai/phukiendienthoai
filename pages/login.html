<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="../assets/bootstrap-5.3.3-dist/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="../css/library.css" />
    <link rel="stylesheet" href="../css/header.css" />
    <link rel="stylesheet" href="../css/footer.css" />
    <link rel="stylesheet" href="../css/login.css" />
    <script src="../assets/bootstrap-5.3.3-dist/js/bootstrap.min.js"></script>
    <title>Đăng nhập</title>
  </head>
  <body>
    <header class="header">
      <div class="header_container">
        <div class="logo">
          <a href="../index.html" class="header_link">Phukiendienthoai</a>
        </div>
      </div>
    </header>

    <main class="main">
      <div class="form login_form">
        <h2 class="form_title">Đăng nhập</h2>
        <div class="form_ask">
          Chưa có tài khoản ?
          <button class="form_link toSignUp">Đăng ký tại đây</button>
        </div>
        <form>
          <div class="form_section mb-3">
            <label for="login_username" class="form-label">Username</label>
            <input
              required
              type="text"
              class="form-control"
              id="login_username"
              aria-describedby="login-usernameHelp"
            />
            <div id="login-usernameHelp" class="form-text"></div>
          </div>
          <div class="form_section mb-3">
            <label for="login_password" class="form-label">Mật khẩu</label>
            <input
              required
              type="password"
              class="form-control"
              id="login_password"
              aria-describedby="passwordHelp"
            />
            <div id="passwordHelp" class="form-text"></div>
          </div>
          <div class="form_section mb-3">
            <span class="form_forgetPassword">Quên mật khẩu ?</span>
          </div>
          <div class="form_section d-grid">
            <button class="btn btn-primary submit_btn login_btn">
              Đăng nhập
            </button>
          </div>
        </form>
      </div>

      <div class="form signup_form">
        <h2 class="form_title">Đăng ký</h2>
        <div class="form_ask">
          Đã có tài khoản ?
          <button class="form_link toLogin">Đăng nhập tại đây</button>
        </div>
        <form>
          <div class="form_section mb-3">
            <label for="signup_email" class="form-label">Email</label>
            <input
              required
              type="email"
              class="form-control"
              id="signup_email"
              aria-describedby="signup-emailHelp"
            />
            <div id="signup-emailHelp" class="form-text"></div>
          </div>
          <div class="form_section mb-3">
            <label for="signup_username" class="form-label">Username</label>
            <input
              required
              type="email"
              class="form-control"
              id="signup_username"
              aria-describedby="signup-usernameHelp"
            />
            <div id="signup-usernameHelp" class="form-text"></div>
          </div>
          <div class="form_section mb-3">
            <label for="signup_password" class="form-label">Mật khẩu</label>
            <input
              required
              type="password"
              class="form-control"
              id="signup_password"
              aria-describedby="signup-passwordHelp"
            />
            <div id="signup-passwordHelp" class="form-text"></div>
          </div>
          <div class="form_section mb-3">
            <label for="signup_cfpassword" class="form-label"
              >Nhập lại mật khẩu</label
            >
            <input
              required
              type="password"
              class="form-control"
              id="signup_cfpassword"
              aria-describedby="cfpasswordHelp"
            />
            <div id="cfpasswordHelp" class="form-text"></div>
          </div>
          <div class="form_section mb-3 mt-4 d-grid">
            <button class="btn btn-primary submit_btn signup_btn">
              Đăng ký
            </button>
          </div>
          <div class="form_section">
            <span class="form_policy"
              >Bằng việc đăng ký, bạn đã đồng ý với chúng tôi về
              <span class="policy">Điều khoản dịch vụ</span> &
              <span class="policy">Chính sách bảo mật</span>
            </span>
          </div>
        </form>
      </div>

      <div class="form resetPassword_form">
        <div class="form_back_btn">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="22"
            width="22"
            viewBox="0 0 448 512"
            class="form_icon"
          >
            <path
              d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"
            />
          </svg>
        </div>
        <h2 class="form_title mb-3">Đặt lại mật khẩu</h2>
        <form>
          <div class="form_section mb-3">
            <label for="reset_password" class="form-label">Mật khẩu mới</label>
            <input
              required
              type="password"
              class="form-control"
              id="reset_password"
              aria-describedby="reset-passwordHelp"
            />
            <div id="reset-passwordHelp" class="form-text"></div>
          </div>
          <div class="form_section mb-3">
            <label for="reset_cfpassword" class="form-label"
              >Nhập lại mật khẩu</label
            >
            <input
              required
              type="password"
              class="form-control"
              id="reset_cfpassword"
              aria-describedby="reset-cfpasswordHelp"
            />
            <div id="reset-cfpasswordHelp" class="form-text"></div>
          </div>
          <div class="form_section mb-3 mt-4 d-grid">
            <button class="btn btn-primary submit_btn confirm_btn">
              Xác nhận
            </button>
          </div>
        </form>
      </div>
    </main>

    <footer class="footer">
      <div class="footer_container">
        <div class="infor">
          22692311 - Trương Công Hải - Đại học Công nghiệp TPHCM
        </div>

        <div class="copyright">
          © 2024 - Bản quyền thuộc về Phukiendienthoai
        </div>
      </div>
    </footer>

    <script>
      const redirectLoginBtn = document.querySelector(".toLogin");
      const redirectSignUpBtn = document.querySelector(".toSignUp");
      const resetPasswordBtn = document.querySelector(".form_forgetPassword");
      const submitLogin = document.querySelector(".login_btn");
      const submitSignUp = document.querySelector(".signup_btn");
      const backBtn = document.querySelector(".form_back_btn");
      const submitReset = document.querySelector(".confirm_btn");

      const resetLoginForm = () => {
        const username = document.getElementById("login_username");
        const password = document.getElementById("login_password");

        document.getElementById("login-usernameHelp").innerText = "";
        document.getElementById("passwordHelp").innerText = "";
        username.style.border = "1px solid #ccc";
        password.style.border = "1px solid #ccc";
        username.value = "";
        password.value = "";
      };

      const resetSignUpForm = () => {
        const username = document.getElementById("signup_username");
        const email = document.getElementById("signup_email");
        const password = document.getElementById("signup_password");
        const cfpassword = document.getElementById("signup_cfpassword");

        document.getElementById("signup-emailHelp").innerText = "";
        document.getElementById("signup-passwordHelp").innerText = "";
        document.getElementById("cfpasswordHelp").innerText = "";
        document.getElementById("signup-usernameHelp").innerText = "";
        email.style.border = "1px solid #ccc";
        password.style.border = "1px solid #ccc";
        cfpassword.style.border = "1px solid #ccc";
        username.style.border = "1px solid #ccc";
        email.value = "";
        password.value = "";
        cfpassword.value = "";
        username.value = "";
      };

      const resetChangePassForm = () => {
        const password = document.getElementById("reset_password");
        const cfpassword = document.getElementById("reset_cfpassword");

        document.getElementById("reset-passwordHelp").innerText = "";
        document.getElementById("reset-cfpasswordHelp").innerText = "";
        password.style.border = "1px solid #ccc";
        cfpassword.style.border = "1px solid #ccc";
        password.value = "";
        cfpassword.value = "";
      };

      backBtn.addEventListener("click", () => {
        document.querySelector(".resetPassword_form").style.display = "none";
        document.querySelector(".login_form").style.display = "block";
        resetLoginForm();
      });

      resetPasswordBtn.addEventListener("click", () => {
        document.querySelector(".login_form").style.display = "none";
        document.querySelector(".resetPassword_form").style.display = "block";
        resetChangePassForm();
      });

      redirectSignUpBtn.addEventListener("click", () => {
        document.querySelector(".login_form").style.display = "none";
        document.querySelector(".signup_form").style.display = "block";
        resetSignUpForm();
      });

      redirectLoginBtn.addEventListener("click", () => {
        document.querySelector(".login_form").style.display = "block";
        document.querySelector(".signup_form").style.display = "none";
        resetLoginForm();
      });

      const handleLogin = () => {
        const username = document.getElementById("login_username");
        const password = document.getElementById("login_password");
        let valid = true;

        if (
          username.value.trim().length === 0 ||
          !/^[a-zA-Z0-9]+$/.test(username.value)
        ) {
          const usernameText = document.getElementById("login-usernameHelp");
          usernameText.style.color = "red";
          usernameText.innerText = "Username không hợp lệ!! Vui lòng thử lại";
          username.style.border = "1px solid red";
          valid = false;
        } else {
          const usernameText = document.getElementById("login-usernameHelp");
          usernameText.style.color = "green";
          usernameText.innerText = "Chính xác !!";
          username.style.border = "1px solid green";
        }

        if (password.value !== "12345678") {
          const passwordText = document.getElementById("passwordHelp");
          passwordText.style.color = "red";
          passwordText.innerText =
            "Mật khẩu không chính xác!! Vui lòng thử lại";
          password.style.border = "1px solid red";
          valid = false;
        } else {
          const passwordText = document.getElementById("passwordHelp");
          passwordText.style.color = "green";
          passwordText.innerText = "Chính xác !!";
          password.style.border = "1px solid green";
        }

        if (!valid) {
          return;
        }

        localStorage.setItem("userName", username.value);
        window.location.href = "../index.html";
        username.value = "";
        password.value = "";
      };
      submitLogin.addEventListener("click", (e) => {
        e.preventDefault();
        handleLogin();
      });

      const handleSignUp = () => {
        const email = document.getElementById("signup_email");
        const username = document.getElementById("signup_username");
        const password = document.getElementById("signup_password");
        const cfpassword = document.getElementById("signup_cfpassword");
        let valid = true;

        if (!/\S+@\S+\.\S+/.test(email.value)) {
          const emailText = document.getElementById("signup-emailHelp");
          emailText.style.color = "red";
          emailText.innerText = "Email không hợp lệ!! Vui lòng thử lại";
          email.style.border = "1px solid red";
          valid = false;
        } else {
          const emailText = document.getElementById("signup-emailHelp");
          emailText.style.color = "green";
          emailText.innerText = "Email hợp lệ";
          email.style.border = "1px solid green";
        }
        if (
          username.value.trim().length === 0 ||
          !/^[a-zA-Z0-9]+$/.test(username.value)
        ) {
          const usernameText = document.getElementById("signup-usernameHelp");
          usernameText.style.color = "red";
          usernameText.innerText = "Username không hợp lệ!! Vui lòng thử lại";
          username.style.border = "1px solid red";
          valid = false;
        } else {
          const usernameText = document.getElementById("signup-usernameHelp");
          usernameText.style.color = "green";
          usernameText.innerText = "Username hợp lệ";
          username.style.border = "1px solid green";
        }
        if (
          password.value.trim().length < 8 ||
          password.value.trim().length > 20
        ) {
          const passwordText = document.getElementById("signup-passwordHelp");
          passwordText.style.color = "red";
          passwordText.innerText = "Mật khẩu phải từ 8 đến 20 kí tự";
          password.style.border = "1px solid red";
          valid = false;
        } else {
          const passwordText = document.getElementById("signup-passwordHelp");
          passwordText.style.color = "green";
          passwordText.innerText = "Mật khẩu hợp lệ";
          password.style.border = "1px solid green";
        }
        if (
          cfpassword.value.trim().length < 8 ||
          cfpassword.value.trim().length > 20
        ) {
          const cfpasswordText = document.getElementById("cfpasswordHelp");
          cfpasswordText.style.color = "red";
          cfpasswordText.innerText = "Mật khẩu phải từ 8 đến 20 kí tự";
          cfpassword.style.border = "1px solid red";
          valid = false;
        } else {
          if (password.value.trim() !== cfpassword.value.trim()) {
            const cfpasswordText = document.getElementById("cfpasswordHelp");
            cfpasswordText.style.color = "red";
            cfpasswordText.innerText = "Mật khẩu không trùng khớp";
            cfpassword.style.border = "1px solid red";
            valid = false;
          } else {
            const cfpasswordText = document.getElementById("cfpasswordHelp");
            cfpasswordText.style.color = "green";
            cfpasswordText.innerText = "Mật khẩu trùng khớp";
            cfpassword.style.border = "1px solid green";
          }
        }

        if (!valid) {
          return;
        }

        localStorage.setItem("userName", username.value);
        window.location.href = "../index.html";
        email.value = "";
        password.value = "";
        cfpassword.value = "";
      };
      submitSignUp.addEventListener("click", (e) => {
        e.preventDefault();
        handleSignUp();
      });

      const handleResetPass = () => {
        const password = document.getElementById("reset_password");
        const cfpassword = document.getElementById("reset_cfpassword");

        if (
          password.value.trim().length < 8 ||
          password.value.trim().length > 20
        ) {
          const passwordText = document.getElementById("reset-passwordHelp");
          passwordText.style.color = "red";
          passwordText.innerText = "Mật khẩu phải từ 8 đến 20 kí tự";
          password.style.border = "1px solid red";
        } else {
          const passwordText = document.getElementById("reset-passwordHelp");
          passwordText.style.color = "green";
          passwordText.innerText = "Mật khẩu hợp lệ";
          password.style.border = "1px solid green";
        }
        if (
          cfpassword.value.trim().length < 8 ||
          cfpassword.value.trim().length > 20
        ) {
          const cfpasswordText = document.getElementById(
            "reset-cfpasswordHelp"
          );
          cfpasswordText.style.color = "red";
          cfpasswordText.innerText = "Mật khẩu phải từ 8 đến 20 kí tự";
          cfpassword.style.border = "1px solid red";
          return;
        } else {
          if (password.value.trim() !== cfpassword.value.trim()) {
            const cfpasswordText = document.getElementById(
              "reset-cfpasswordHelp"
            );
            cfpasswordText.style.color = "red";
            cfpasswordText.innerText = "Mật khẩu không trùng khớp";
            cfpassword.style.border = "1px solid red";
            return;
          } else {
            const cfpasswordText = document.getElementById(
              "reset-cfpasswordHelp"
            );
            cfpasswordText.style.color = "green";
            cfpasswordText.innerText = "Mật khẩu trùng khớp";
            cfpassword.style.border = "1px solid green";
          }
        }

        document.querySelector(".resetPassword_form").style.display = "none";
        document.querySelector(".login_form").style.display = "block";
        resetLoginForm();

        password.value = "";
        cfpassword.value = "";
      };
      submitReset.addEventListener("click", (e) => {
        e.preventDefault();
        handleResetPass();
      });
    </script>
  </body>
</html>
